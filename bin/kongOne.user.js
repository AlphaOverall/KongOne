var PRS$0=function(e,t){return e.__proto__={a:t},e.a===t}({},{}),DP$0=Object.defineProperty,GOPD$0=Object.getOwnPropertyDescriptor,MIXIN$0=function(e,t){for(var o in t)t.hasOwnProperty(o)&&DP$0(e,o,GOPD$0(t,o));return e},SP$0=Object.setPrototypeOf||function(e,t){return PRS$0?e.__proto__=t:DP$0(e,"__proto__",{value:t,configurable:!0,enumerable:!1,writable:!0}),e},OC$0=Object.create,Script=function(){"use strict";function e(e,t,o){this.name=e,this.path=t,this.dom=null,this.defaultEnabled=o}var t={};return DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t.checkPath=function(){var e=document.location.pathname;return e.match(this.path)},t.initialize=function(){this.dom="undefined"==typeof unsafeWindow?window:unsafeWindow,this.defaultEnabled||"null"!=GM_getValue("onescript-"+this.name,"null")||GM_setValue("onescript-"+this.name,"false"),this.checkPath()&&"true"==GM_getValue("onescript-"+this.name,"true")&&(console.log("[KongOne] Adding Script: "+this.name),this.run(),this.added=!0)},t.run=function(){throw"run() not implemented for #{this.name} script"},MIXIN$0(e.prototype,t),t=void 0,e}(),HolodeckScript=function(e){"use strict";function t(t,o,i){e.prototype.constructor.call(this,t,o,i),this.holodeckCheckCounter=0}PRS$0||MIXIN$0(t,e);var o={};return null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),o.initialize=function(){var o=this;return this.holodeckCheckCounter++,"undefined"!=typeof holodeck&&holodeck.ready?void e.prototype.initialize.call(this):this.holodeckCheckCounter>t.COUNTER_LIMIT?void console.log("[KongOne] "+this.name+" failed to load holodeck"):void setTimeout(function(){return o.initialize()},100)},MIXIN$0(t.prototype,o),o=void 0,t}(Script);HolodeckScript.COUNTER_LIMIT=100;var ChatTimestamp=function(e){"use strict";function t(){e.prototype.constructor.call(this,"Chat Timestamp","games",!0)}PRS$0||MIXIN$0(t,e);var o={};return null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),o.run=function(){var e=this.dom,t=e.holodeck,o=e.ChatDialogue;if(t&&o&&(o.prototype=e.CDprototype||e.ChatDialogue.prototype,!t.__timestamp)){t.__timestamp=!0,t.addChatCommand("timeformat",function(e,t){var o=t.match(/^\/\S+\s+(\d+)/),i="",n=e.activeDialogue();return o&&(i=o[1]),12==i||24==i?(e._timeFormat=i,window.setTimeout(function(){GM_setValue("kong_timeformat",i)},0),n.displayMessage("Timeformat","Set to "+i+"-hour clock (hh:mm:ss"+(12==i?" AM/PM)":")"),{class:"whisper received_whisper"},{non_user:!0})):n.displayMessage("Timeformat","Allowed values: 12 and 24",{class:"whisper received_whisper"},{non_user:!0}),!1}),t.addChatCommand("tscolor",function(e,t){var o=t.match(/^\/\S+\s+([0-9a-f]{6})/i),i="";return o&&(i="#"+o[1]),i?(a(i),window.setTimeout(function(){GM_setValue("kong_timestampcolor",i)},0),e.activeDialogue().displayMessage("Timestamp","Set font-color to "+i,{class:"whisper received_whisper"},{non_user:!0})):e.activeDialogue().displayMessage("Timestamp","No valid color! Format is /tscolor ###### (# = hex character)",{class:"whisper received_whisper"},{non_user:!0}),!1}),t.addChatCommand("toggleseconds",function(e,t){return e._showSeconds?(e._showSeconds=0,e.activeDialogue().displayMessage("Timestamp","Now hiding seconds",{class:"whisper received_whisper"},{non_user:!0})):(e._showSeconds=1,e.activeDialogue().displayMessage("Timestamp","Now showing seconds",{class:"whisper received_whisper"},{non_user:!0})),window.setTimeout(function(){GM_setValue("kong_timeshowseconds",e._showSeconds)},0),!1});var i=12,n="#999999",r=0;i=GM_getValue("kong_timeformat",12)||12,n=GM_getValue("kong_timestampcolor","#999999")||"#999999",r=GM_getValue("kong_timeshowseconds",0)||0,t._timeFormat=i,t._showSeconds=r;var a=function(e){function t(e){o.innerHTML="span.inline_timestamp { color: "+e+" !important; }"}var o=document.createElement("style");return o.setAttribute("type","text/css"),t(e),document.body.appendChild(o),t}(n);o.MESSAGE_TEMPLATE.template='<p class="#{classNames}"><span style="float: left;" class="inline_timestamp">[#{time}]&nbsp;</span><span username="#{username}" class="username #{userClassNames}">#{prefix}#{username}</span><span class="separator">: </span><span class="message">#{message}</span><span class="clear"></span></p>',o.MESSAGE_TEMPLATE.old_evaluate_inline=o.MESSAGE_TEMPLATE.evaluate,o.MESSAGE_TEMPLATE.evaluate=function(e){var o,i=new Date,n=i.getHours(),r=i.getMinutes(),a=i.getSeconds();return o=12==t._timeFormat?(n<10?0===n?"12":"0"+n:n>12?n>21?n-12:"0"+(n-12):n)+":"+(r<10?"0":"")+r+(t._showSeconds?":"+(a<10?"0":"")+a:"")+(n>11?" PM":" AM"):(n<10?"0":"")+n+":"+(r<10?"0":"")+r+(t._showSeconds?":"+(a<10?"0":"")+a:""),e.time=o,this.old_evaluate_inline(e)}}},MIXIN$0(t.prototype,o),o=void 0,t}(HolodeckScript),ShowScriptOptions=function(e){"use strict";function t(){e.prototype.constructor.call(this,"this","accounts",!0),this.scripts=[]}PRS$0||MIXIN$0(t,e);var o={};return null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),o.run=function(){var e=(this.dom,new Element("div",{style:"background-color:#FFF;padding: 8px;"}).update("<h2>Scripts</h2>Enable - Script Name<p></p>"));$("profile_aside").down().insert(e),this.scripts.each(function(t){var o=this;if("this"==t.name)return!0;var i=new Element("span",{style:"margin-top: 5px !important;display: block;"});e.insert(i);var n=new Element("input",{type:"checkbox",id:"onescript-"+t.name,style:"margin-top:2px;vertical-align:top;margin-right:8px;"}),r=new Element("label",{class:"pls"});n.checked="true"==GM_getValue(n.id,t.defaultEnabled?"true":"false"),r.update(t.name),i.insert(n),i.insert(r),n.addEventListener("change",function(e){console.log("[KongOne] Toggled script"),GM_setValue(o.id,o.checked)})})},MIXIN$0(t.prototype,o),o=void 0,t}(Script),WhisperCatch=function(e){"use strict";function t(){e.prototype.constructor.call(this,"Whisper Catch","games",!0)}PRS$0||MIXIN$0(t,e);var o={};return null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),o.run=function(){var e=this.dom,o=e.ChatDialogue;holodeck.__wc_whisperCount=0,o.prototype.__wc_receivedPrivateMessage=o.prototype.receivedPrivateMessage,o.prototype.receivedPrivateMessage=function(e){this.__wc_receivedPrivateMessage(e),e.id=holodeck.__wc_whisperCount;var o=JSON.parse(localStorage.getItem(t.WHISPERS_SAVED_KEY))||[];o.push(e),localStorage.setItem(t.WHISPERS_SAVED_KEY,JSON.stringify(o)),setTimeout(this.removeWhisper,t.WHISPER_WAIT_TIME,e)},this.__wc_interval=setInterval(restoreWhispers,t.CHAT_DIALOGUE_RETRY),holodeck.addChatCommand("wctime",function(e,o){var i=o.split(" ").slice(1),n=parseInt(i[0]);return isNaN(n)||(localStorage.setItem(t.WHISPER_WAIT_TIME_KEY,n),e.activeDialogue().displayUnsanitizedMessage("Kong Bot","Whisper save time set to "+n+" seconds.",{class:"whisper received_whisper"},{non_user:!0})),!1})},o.restoreWhispers=function(){var e=holodeck.activeDialogue(),o=JSON.parse(localStorage.getItem(t.WHISPERS_SAVED_KEY))||[];if(e){for(;o.length>0;){var i=o.shift();e.receivedPrivateMessage(i)}clearInterval(this.__wc_interval)}},o.removeWhisper=function(e){var o=(JSON.parse(localStorage.getItem(t.WHISPERS_SAVED_KEY))||[]).filter(function(t){return t.id!=e.id});localStorage.setItem(t.WHISPERS_SAVED_KEY,JSON.stringify(o))},MIXIN$0(t.prototype,o),o=void 0,t}(HolodeckScript);WhisperCatch.WHISPERS_SAVED_KEY="wc-whispers_saved",WhisperCatch.WHISPER_WAIT_TIME_KEY="wc-whisper_wait_time_key",WhisperCatch.WHISPER_WAIT_TIME=1e3*parseInt(localStorage.getItem(WhisperCatch.WHISPER_WAIT_TIME_KEY)||15),WhisperCatch.CHAT_DIALOGUE_RETRY=100,function(){console.log("KongOne Script running."),"undefined"==typeof GM_setValue&&(window.GM_setValue=function(e,t){localStorage.setItem(e,t)},window.GM_getValue=function(e,t){var o=localStorage.getItem(e);return null===o?t:o},window.GM_deleteValue=function(e){localStorage.removeItem(e)});var e=new ShowScriptOptions,t=[e,new WhisperCatch,new ChatTimestamp];e.scripts=t,t.each(function(e){return e.initialize()})}();